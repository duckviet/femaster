{
  "id": "nested-comments",
  "title": "Nested Comments System",
  "domain": "react-architecture",
  "subcategory": "recursive-ui",
  "difficulty": "Mid",
  "statement": "Xây dựng một thành phần hiển thị hệ thống bình luận nhiều cấp (nested comments). Dữ liệu đầu vào là một mảng các object có cấu trúc phân cấp. Mỗi bình luận có thể có một mảng `replies`.",
  "constraints": [
    "Độ sâu tối đa của dữ liệu không xác định (phải dùng đệ quy).",
    "Nếu `replies` trống hoặc không tồn tại, không hiển thị nút 'Expand'.",
    "Trạng thái đóng/mở (toggle) của mỗi nhánh phải độc lập."
  ],
  "complexity": "Render: O(n) với n là tổng số bình luận.",
  "codeLines": [
    "import React, { useState } from \"react\";",
    "",
    "interface Comment {",
    "  id: string;",
    "  text: string;",
    "  replies?: Comment[];",
    "}",
    "",
    "const CommentItem = ({ comment }: { comment: Comment }) => {",
    "  const [isExpanded, setIsExpanded] = useState(true);",
    "  const hasReplies = comment.replies && comment.replies.length > 0;",
    "",
    "  return (",
    "    <div style={{ marginLeft: \"20px\", borderLeft: \"1px solid #ccc\" }}>",
    "      <div style={{ padding: \"8px\" }}>",
    "        <p>{comment.text}</p>",
    "        {hasReplies && (",
    "          <button onClick={() => setIsExpanded(!isExpanded)}>",
    "            {isExpanded ? \"Hide Replies\" : `Show ${comment.replies?.length}`}",
    "          </button>",
    "        )}",
    "      </div>",
    "      {isExpanded && hasReplies && (",
    "        <div>",
    "          {comment.replies!.map((reply) => (",
    "            <CommentItem key={reply.id} comment={reply} />",
    "          ))}",
    "        </div>",
    "      )}",
    "    </div>",
    "  );",
    "};",
    "",
    "export const CommentSystem = ({ data }: { data: Comment[] }) => {",
    "  return (",
    "    <div>",
    "      {data.map((comment) => (",
    "        <CommentItem key={comment.id} comment={comment} />",
    "      ))}",
    "    </div>",
    "  );",
    "};"
  ],
  "language": "tsx",
  "commonMistakes": [
    "Quên thuộc tính `key` khi render list trong đệ quy.",
    "Không handle trường hợp `replies` là `undefined` hoặc `null`.",
    "Để state 'isExpanded' ở component cha thay vì component con."
  ],
  "demoComponentKey": "nested-comments"
}
