{
  "id": "use-debounce",
  "title": "useDebounce Search",
  "domain": "performance-scalability",
  "subcategory": "network-caching",
  "difficulty": "Mid",
  "statement": "Viết một custom hook `useDebounce` để trì hoãn việc cập nhật một giá trị và áp dụng nó vào một ô Search Input để gọi API.",
  "constraints": [
    "User gõ liên tục thì không được gọi API.",
    "Phải cleanup timeout nếu component bị unmount hoặc giá trị thay đổi nhanh chóng."
  ],
  "complexity": "Time: O(1) cho mỗi lần update.",
  "codeLines": [
    "import { useState, useEffect } from \"react\";",
    "",
    "function useDebounce<T>(value: T, delay: number): T {",
    "  const [debouncedValue, setDebouncedValue] = useState<T>(value);",
    "",
    "  useEffect(() => {",
    "    const handler = setTimeout(() => {",
    "      setDebouncedValue(value);",
    "    }, delay);",
    "",
    "    return () => {",
    "      clearTimeout(handler);",
    "    };",
    "  }, [value, delay]);",
    "",
    "  return debouncedValue;",
    "}",
    "",
    "// Usage",
    "export const SearchBox = () => {",
    "  const [searchTerm, setSearchTerm] = useState(\"\");",
    "  const debouncedSearch = useDebounce(searchTerm, 500);",
    "",
    "  useEffect(() => {",
    "    if (debouncedSearch) {",
    "      console.log(\"Fetching API for:\", debouncedSearch);",
    "    }",
    "  }, [debouncedSearch]);",
    "",
    "  return (",
    "    <input",
    "      type=\"text\"",
    "      value={searchTerm}",
    "      onChange={(e) => setSearchTerm(e.target.value)}",
    "      placeholder=\"Search...\"",
    "    />",
    "  );",
    "};"
  ],
  "language": "tsx",
  "commonMistakes": [
    "Quên `return () => clearTimeout(handler)`.",
    "Sử dụng `lodash.debounce` bên trong thân component mà không dùng `useMemo`."
  ],
  "demoComponentKey": "use-debounce"
}
